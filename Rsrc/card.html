<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aine's 18th Birthday</title>
    <link rel="stylesheet" href="../Public/styles.css">
    <!--Fonts-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?display=swap&family=Aref+Ruqaa:wght@700&family=Dancing+Script:wght@700" rel="stylesheet">
</head>
<body>
    <div id="cMainBackground">
        <div id = "cContent">
            <p>Mere words cannot explain how much I adore you</p>
            <p>Through these melodies, I express the rhytm of my heart to you  </p>
            <div class = "card-border">
                <div class ="card-photo" style="background-image: url('../Assets/Cards/arawAraw.jpg')"></div>
                <p class = "qoute">"Pipiliin ka sa Araw-Araw"</p>
                <div class = "card-info">
                    <p>Araw-Araw</p>
                    <p>Ben&Ben</p>
                </div>
                <audio class="card-audio" src="../Assets/Music/arawAraw.mp3"></audio>
            </div>
            <div class = "card-border">
                <div class ="card-photo" style="background-image: url('../Assets/Cards/theNightWeMet.jpg')"></div>
                <p class = "qoute">"Take me back to the Night We Met"</p>
                <div class = "card-info">
                    <p>The Night We Met</p>
                    <p>Lord Huron</p>
                </div>
                <audio class="card-audio" src="../Assets/Music/theNightWeMet.mp3"></audio>
            </div>
            <div class = "card-border">
                <div class ="card-photo" style="background-image: url('../Assets/Cards/walkingBackHome.png')"></div>
                <p class = "qoute">"The nights are bright when you linger"</p>
                <div class = "card-info">
                    <p>Walking Back Home</p>
                    <p>FUR</p>
                </div>
                <audio class="card-audio" src="../Assets/Music/walkingBackHome.mp3"></audio>
            </div>
            <div class = "card-border">
                <div class ="card-photo" style="background-image: url('../Assets/Cards/shotPuno.jpg')"></div>
                <p class = "qoute">"Sa karagatan ng mga tao, ikaw ang nakikita ko"</p>
                <div class = "card-info">
                    <p>Shot Puno</p>
                    <p>Juan Karlos</p>
                </div>
                <audio class="card-audio" src="../Assets/Music/shotPuno.mp3"></audio>
            </div>
            <div class = "card-border">
                <div class ="card-photo" style="background-image: url('../Assets/Cards/thoseEyes.jpg')"></div>
                <p class = "qoute">"The small things you do made me fall inlove with you"</p>
                <div class = "card-info">
                    <p>Those Eyes</p>
                    <p>New West</p>
                </div>
                <audio class="card-audio" src="../Assets/Music/thoseEyes.mp3"></audio>
            </div>
            <div class = "card-border">
                <div class ="card-photo" style="background-image: url('../Assets/Cards/solomon.jpg')"></div>
                <p class = "qoute">"Ang damdamin ko'y sa'yong sa'yo"</p>
                <div class = "card-info">
                    <p>Solomon</p>
                    <p>Munimuni, Claire Benin</p>
                </div>
                <audio class="card-audio" src="../Assets/Music/solomon.mp3"></audio>
            </div>
            <div class = "card-border">
                <div class ="card-photo" style="background-image: url('../Assets/Cards/janice.jpg')"></div>
                <p class = "qoute">"Hali ka rito. Sumugal ka nang sampung minuto"</p>
                <div class = "card-info">
                    <p>Janice</p>
                    <p>Dilaw</p>
                </div>
                <audio class="card-audio" src="../Assets/Music/janice.mp3"></audio>
            </div>
            <div class = "card-border">
                <div class ="card-photo" style="background-image: url('../Assets/Cards/kalachuci.jpg')"></div>
                <p class = "qoute">"Nasa'yong daliri ang init na bubuhay sa'kin"</p>
                <div class = "card-info">
                    <p>Kalachuchi</p>
                    <p>Munimuni</p>
                </div>
                <audio class="card-audio" src="../Assets/Music/kalachuchi.mp3"></audio>
            </div>
            <div class = "card-border">
                <div class ="card-photo" style="background-image: url('../Assets/Cards/iHearASymphony.jpg')"></div>
                <p class = "qoute">"I hear it when I look at you"</p>
                <div class = "card-info">
                    <p>I Hear A Symphony</p>
                    <p>Cody Fry</p>
                </div>
                <audio class="card-audio" src="../Assets/Music/iHearASymphony.mp3"></audio>
            </div>
            <div class = "card-border">
                <div class ="card-photo" style="background-image: url('../Assets/Cards/courage.jpg')"></div>
                <p class = "qoute">"Keep carrying on with courage"</p>
                <div class = "card-info">
                    <p>Courage</p>
                    <p>Ben&Ben</p>
                </div>
                <audio class="card-audio" src="../Assets/Music/courage.mp3"></audio>
            </div>
        </div>
        <div id = "imageBackground" ></div>
    </div>
<script>
document.addEventListener("DOMContentLoaded", () => {
    const cards = document.querySelectorAll(".card-border");
    const container = document.getElementById("cContent");
    let currentCardIndex = null;
    let firstTapDone = false;
    let isPausedByUser = false;

    // -------------------------
    // Function: Update Focus
    // -------------------------
    function updateFocus() {
        const viewportCenter = window.innerHeight / 2;
        let closestIndex = -1;
        let minDistance = Infinity;

        cards.forEach((card, index) => {
            const rect = card.getBoundingClientRect();
            const cardCenter = rect.top + rect.height / 2;
            const distance = Math.abs(viewportCenter - cardCenter);
            if (distance < minDistance) {
                minDistance = distance;
                closestIndex = index;
            }
        });

        if (closestIndex !== currentCardIndex) {
            // Stop previous card‚Äôs audio
            if (currentCardIndex !== null) {
                const prevAudio = cards[currentCardIndex].querySelector(".card-audio");
                if (prevAudio) {
                    prevAudio.pause();
                    prevAudio.currentTime = 0;
                }
            }

            // Play new card‚Äôs audio (only after first tap)
            const newAudio = cards[closestIndex].querySelector(".card-audio");
            if (newAudio && firstTapDone && !isPausedByUser) {
                newAudio.loop = true;
                newAudio.currentTime = 0;
                newAudio.play().catch(() => {
                    console.log(`Autoplay blocked for card ${closestIndex + 1}`);
                });
            }

            currentCardIndex = closestIndex;
            console.log(`üéµ Card ${currentCardIndex + 1} in focus`);
        }
    }

    // -------------------------
    // Scroll Listener
    // -------------------------
    container.addEventListener("scroll", () => {
        requestAnimationFrame(updateFocus);
    });

    // -------------------------
// Tap Listener (Fixed for Mobile)
// -------------------------
document.addEventListener("click", (e) => {
    const isInsideCard = e.target.closest(".card-border");
    const currentAudio =
        currentCardIndex !== null
            ? cards[currentCardIndex].querySelector(".card-audio")
            : null;

    // 1Ô∏è‚É£ First tap unlocks audio for ALL tracks
    if (!firstTapDone) {
        firstTapDone = true;
        console.log("üîì First tap ‚Äî unlocking all audio elements");

        cards.forEach((card) => {
            const audio = card.querySelector(".card-audio");
            if (audio) {
                audio.muted = true;
                audio.play().then(() => {
                    audio.pause();
                    audio.muted = false;
                }).catch(() => {});
            }
        });

        // Start current audio right away
        if (currentAudio) {
            currentAudio.loop = true;
            currentAudio.play().catch(() => console.log("Blocked"));
        }
        return;
    }

    // 2Ô∏è‚É£ Later taps outside toggle pause/resume
    if (!isInsideCard && currentAudio) {
        if (!isPausedByUser && !currentAudio.paused) {
            currentAudio.pause();
            isPausedByUser = true;
            console.log("‚è∏Ô∏è Audio paused");
        } else {
            currentAudio.play().catch(() => console.log("Resume blocked"));
            isPausedByUser = false;
            console.log("‚ñ∂Ô∏è Audio resumed");
        }
    }
});


    updateFocus();
});
</script>




</body>

</html>